<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bienvenido al sistema de apartado de proyector del Instituto Tecnológico de Oaxaca</title>
  <style>
    body { font-family: Segoe UI, Arial, sans-serif; background:#f6f7fb; margin:0; padding:20px; }
    h1 { margin-bottom:15px; }
    table { width:100%; border-collapse:collapse; background:white; box-shadow:0 4px 12px rgba(0,0,0,0.1); }
    th, td { padding:10px; border-bottom:1px solid #eee; font-size:14px; }
    th { background:#007bff; color:white; text-align:left; }
  </style>
</head>
<body>

<h1>Bienvenido al sistema de apartado de proyector del Instituto Tecnológico de Oaxaca</h1>

<table>
  <thead>
    <tr>
      <th>Fecha</th>
      <th>Horario</th>
      <th>Alumno</th>
      <th>Número de Control</th>
      <th>Aula</th>
      <th>Material</th>
      <th>Carrera</th>
    </tr>
  </thead>
  <tbody id="tbody"></tbody>
</table>

<script>
const registros = JSON.parse(localStorage.getItem("apartados") || "[]");
const tbody = document.getElementById("tbody");

// Convierte "07:00 AM" a "7AM-8AM"
function formatoRango(horaStr) {
  if (!horaStr) return "N/A";

  // Ejemplo: "07:00 AM"
  let [horaMinuto, periodo] = horaStr.split(" ");
  let [h] = horaMinuto.split(":").map(Number);

  // Convertir a 24h para calcular la hora siguiente
  let hora24 = periodo === "PM" && h !== 12 ? h + 12 : h;
  if (periodo === "AM" && h === 12) hora24 = 0;

  let siguiente = (hora24 + 1) % 24;

  // Función para formatear AM/PM limpio
  const f = hr => {
    const suf = hr >= 12 ? "PM" : "AM";
    let h12 = hr % 12;
    if (h12 === 0) h12 = 12;
    return `${h12}${suf}`;
  };

  return `${f(hora24)}-${f(siguiente)}`;
}

tbody.innerHTML = registros.map(r => `
  <tr>
    <td>${r.fecha}</td>
    <td>${formatoRango(r.hora)}</td>
    <td>${r.nombre}</td>
    <td>${r.numeroControl || "N/A"}</td>
    <td>${r.aula}</td>
    <td>${(r.material || []).join(', ')}</td>
    <td>${r.carrera}</td>
  </tr>
`).join("");
</script>

</body>
</html>
